/**
 * @jest-environment jsdom
 */

import { getImageUrl } from "./getImageUrl";
test('Extract image url from srcset', () => {
  document.body.innerHTML = `<img alt="MEIN BESTES Weltmeister-Chia-BrÃ¶tchen von ALDI Nord" class="img-responsive img-contain cq-dd-image loaded" loading="lazy" sizes="(min-width: 1024px) 288px, (min-width: 768px) 235px, 50vw" srcset="/content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.288w.png.res/1627053087425/opt.288w.png 288w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.440w.png.res/1627053087425/opt.440w.png 440w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.592w.png.res/1627053087425/opt.592w.png 592w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.736w.png.res/1627053087425/opt.736w.png 736w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.900w.png.res/1627053087425/opt.900w.png 900w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.1250w.png.res/1627053087425/opt.1250w.png 1250w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.1817w.png.res/1627053087425/opt.1817w.png 1817w, /content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.2800w.png.res/1627053087425/opt.2800w.png 2800w" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-was-processed="true">`;
  const image = document.querySelector('img') as HTMLImageElement;
  expect(getImageUrl(image)).toBe('https://www.aldi-nord.de/content/dam/aldi/germany/angebote/2021/kw32/produkte/7250_32-2021_Weltmeister-Chia-Broetchen-TS-FSPlus_ON.png/jcr:content/renditions/opt.2800w.png.res/1627053087425/opt.2800w.png');
})